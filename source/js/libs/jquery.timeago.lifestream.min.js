/**
 * Timeago is a jQuery plugin that makes it easy to support automatically
 * updating fuzzy timestamps (e.g. "4 minutes ago" or "about 1 day ago").
 *
 * @name timeago
 * @version 0.11.4
 * @requires jQuery v1.2.3+
 * @author Ryan McGeary
 * @license MIT License - http://www.opensource.org/licenses/mit-license.php
 *
 * For usage and examples, visit:
 * http://timeago.yarp.com/
 *
 * Copyright (c) 2008-2012, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)
 */
/*!
 * jQuery Lifestream Plug-in
 * Show a stream of your online activity
 * @version   0.5.1
 * @author    Christian Vuerings et al.
 * @copyright Copyright 2014, Christian Vuerings - http://denbuzze.com
 * @license   https://github.com/christianv/jquery-lifestream/blob/master/LICENSE MIT
 */
(function(a){function c(){var b=d(this);if(!isNaN(b.datetime)){a(this).text(e(b.datetime))}return this}function d(c){c=a(c);if(!c.data("timeago")){c.data("timeago",{datetime:b.datetime(c)});var d=a.trim(c.text());if(d.length>0&&!(b.isTime(c)&&c.attr("title"))){c.attr("title",d)}}return c.data("timeago")}function e(a){return b.inWords(f(a))}function f(a){return(new Date).getTime()-a.getTime()}a.timeago=function(b){if(b instanceof Date){return e(b)}else if(typeof b==="string"){return e(a.timeago.parse(b))}else if(typeof b==="number"){return e(new Date(b))}else{return e(a.timeago.datetime(b))}};var b=a.timeago;a.extend(a.timeago,{settings:{refreshMillis:6e4,allowFuture:false,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",wordSeparator:" ",numbers:[]}},inWords:function(b){function k(d,e){var f=a.isFunction(d)?d(e,b):d;var g=c.numbers&&c.numbers[e]||e;return f.replace(/%d/i,g)}var c=this.settings.strings;var d=c.prefixAgo;var e=c.suffixAgo;if(this.settings.allowFuture){if(b<0){d=c.prefixFromNow;e=c.suffixFromNow}}var f=Math.abs(b)/1e3;var g=f/60;var h=g/60;var i=h/24;var j=i/365;var l=f<45&&k(c.seconds,Math.round(f))||f<90&&k(c.minute,1)||g<45&&k(c.minutes,Math.round(g))||g<90&&k(c.hour,1)||h<24&&k(c.hours,Math.round(h))||h<42&&k(c.day,1)||i<30&&k(c.days,Math.round(i))||i<45&&k(c.month,1)||i<365&&k(c.months,Math.round(i/30))||j<1.5&&k(c.year,1)||k(c.years,Math.round(j));var m=c.wordSeparator===undefined?" ":c.wordSeparator;return a.trim([d,l,e].join(m))},parse:function(b){var c=a.trim(b);c=c.replace(/\.\d+/,"");c=c.replace(/-/,"/").replace(/-/,"/");c=c.replace(/T/," ").replace(/Z/," UTC");c=c.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(c)},datetime:function(c){var d=b.isTime(c)?a(c).attr("datetime"):a(c).attr("title");return b.parse(d)},isTime:function(b){return a(b).get(0).tagName.toLowerCase()==="time"}});a.fn.timeago=function(){var a=this;a.each(c);var d=b.settings;if(d.refreshMillis>0){setInterval(function(){a.each(c)},d.refreshMillis)}return a};document.createElement("abbr");document.createElement("time")})(jQuery);(function(e){"use strict";e.fn.lifestream=function(t){return this.each(function(){var n=e(this),r=jQuery.extend({classname:"lifestream",feedloaded:null,limit:10,list:[]},t),i={count:r.list.length,items:[]},s=jQuery.extend(true,{},r),o=function(t){e.merge(i.items,t);i.items.sort(function(e,t){return t.date-e.date});var s=i.items,o=s.length<r.limit?s.length:r.limit,u=0,a,f=e('<ul class="'+r.classname+'"/>');for(;u<o;u++){a=s[u];if(a.html){e('<li class="'+r.classname+"-"+a.config.service+'">').data("name",a.config.service).data("url",a.url||"#").data("time",a.date).append(a.html).appendTo(f)}}n.html(f);if(e.isFunction(r.feedloaded)){r.feedloaded()}},u=function(){var t=0,n=r.list.length;delete s.list;for(;t<n;t++){var i=r.list[t];if(e.fn.lifestream.feeds[i.service]&&e.isFunction(e.fn.lifestream.feeds[i.service])&&i.user){i._settings=s;e.fn.lifestream.feeds[i.service](i,o)}}};if(!jQuery.tmpl){jQuery.getScript("//ajax.aspnetcdn.com/ajax/jquery.templates/beta1/"+"jquery.tmpl.min.js",u)}else{u()}})};e.fn.lifestream.createYqlUrl=function(e){return(("https:"===document.location.protocol?"https":"http")+"://query.yahooapis.com/v1/public/yql?q=__QUERY__"+"&env="+"store://datatables.org/alltableswithkeys&format=json").replace("__QUERY__",encodeURIComponent(e))};e.fn.lifestream.feeds=e.fn.lifestream.feeds||{};if(!Object.keys){Object.keys=function(e){if(e!==Object(e)){throw new TypeError("Object.keys called on non-object")}var t=[],n;for(n in e){if(Object.prototype.hasOwnProperty.call(e,n)){t.push(n)}}return t}}})(jQuery);(function(e){e.fn.lifestream.feeds.dribbble=function(t,n){var r=e.extend({},{posted:'posted a shot <a href="${url}">${title}</a>'},t.template);e.ajax({url:"https://api.dribbble.com/players/"+t.user+"/shots",dataType:"jsonp",success:function(i){var s=[],o=0,u;if(i&&i.total){u=i.shots.length;for(;o<u;o++){var a=i.shots[o];s.push({date:new Date(a.created_at),config:t,html:e.tmpl(r.posted,a)})}}n(s)}});return{template:r}}})(jQuery);(function(e){e.fn.lifestream.feeds.forrst=function(t,n){var r=e.extend({},{posted:'posted a ${post_type} <a href="${post_url}">${title}</a>'},t.template);e.ajax({url:"https://forrst.com/api/v2/users/posts?username="+t.user,dataType:"jsonp",success:function(i){var s=[],o=0,u;if(i&&i.resp.length&&i.resp.length>0){u=i.resp.length;for(;o<u;o++){var a=i.resp[o];s.push({date:new Date(a.created_at.replace(" ","T")),config:t,html:e.tmpl(r.posted,a)})}}n(s)}});return{template:r}}})(jQuery);(function(e){e.fn.lifestream.feeds.github=function(t,n){var r=e.extend({},{commitCommentEvent:'commented on <a href="http://github.com/'+'${status.repo.name}">${status.repo.name}</a>',createBranchEvent:'created branch <a href="http://github.com/'+'${status.repo.name}/tree/${status.payload.ref}">'+'${status.payload.ref}</a> at <a href="http://github.com/'+'${status.repo.name}">${status.repo.name}</a>',createRepositoryEvent:"created repository "+'<a href="http://github.com/'+'${status.repo.name}">${status.repo.name}</a>',createTagEvent:'created tag <a href="http://github.com/'+'${status.repo.name}/tree/${status.payload.ref}">'+'${status.payload.ref}</a> at <a href="http://github.com/'+'${status.repo.name}">${status.repo.name}</a>',deleteBranchEvent:"deleted branch ${status.payload.ref} at "+'<a href="http://github.com/${status.repo.name}">'+"${status.repo.name}</a>",deleteTagEvent:"deleted tag ${status.payload.ref} at "+'<a href="http://github.com/${status.repo.name}">'+"${status.repo.name}</a>",followEvent:'started following <a href="http://github.com/'+'${status.payload.target.login}">${status.payload.target.login}</a>',forkEvent:'forked <a href="http://github.com/${status.repo.name}">'+"${status.repo.name}</a>",gistEvent:"${status.payload.action} gist "+'<a href="http://gist.github.com/${status.payload.gist.id}">'+"${status.payload.gist.id}</a>",issueCommentEvent:'commented on issue <a href="http://github.com/'+'${status.repo.name}/issues/${status.payload.issue.number}">'+'${status.payload.issue.number}</a> on <a href="http://github.com/'+'${status.repo.name}">${status.repo.name}</a>',issuesEvent:"${status.payload.action} issue "+'<a href="http://github.com/${status.repo.name}/issues/'+'${status.payload.issue.number}">${status.payload.issue.number}</a> '+'on <a href="http://github.com/${status.repo.name}">'+"${status.repo.name}</a>",pullRequestEvent:"${status.payload.action} pull request "+'<a href="http://github.com/${status.repo.name}/pull/'+'${status.payload.number}">${status.payload.number}</a> on '+'<a href="http://github.com/${status.repo.name}">'+"${status.repo.name}</a>",pushEvent:'pushed to <a href="http://github.com/${status.repo.name}'+'/tree/${status.payload.ref}">${status.payload.ref}</a> at '+'<a href="http://github.com/${status.repo.name}">'+"${status.repo.name}</a>",watchEvent:'started watching <a href="http://github.com/'+'${status.repo.name}">${status.repo.name}</a>'},t.template),i=function(t){if(t.type==="CommitCommentEvent"){return e.tmpl(r.commitCommentEvent,{status:t})}else if(t.type==="CreateEvent"&&t.payload.ref_type==="branch"){return e.tmpl(r.createBranchEvent,{status:t})}else if(t.type==="CreateEvent"&&t.payload.ref_type==="repository"){return e.tmpl(r.createRepositoryEvent,{status:t})}else if(t.type==="CreateEvent"&&t.payload.ref_type==="tag"){return e.tmpl(r.createTagEvent,{status:t})}else if(t.type==="DeleteEvent"&&t.payload.ref_type==="branch"){return e.tmpl(r.deleteBranchEvent,{status:t})}else if(t.type==="DeleteEvent"&&t.payload.ref_type==="tag"){return e.tmpl(r.deleteTagEvent,{status:t})}else if(t.type==="FollowEvent"){return e.tmpl(r.followEvent,{status:t})}else if(t.type==="ForkEvent"){return e.tmpl(r.forkEvent,{status:t})}else if(t.type==="GistEvent"){if(t.payload.action==="create"){t.payload.action="created"}else if(t.payload.action==="update"){t.payload.action="updated"}return e.tmpl(r.gistEvent,{status:t})}else if(t.type==="IssueCommentEvent"){return e.tmpl(r.issueCommentEvent,{status:t})}else if(t.type==="IssuesEvent"){return e.tmpl(r.issuesEvent,{status:t})}else if(t.type==="PullRequestEvent"){return e.tmpl(r.pullRequestEvent,{status:t})}else if(t.type==="PushEvent"){t.payload.ref=t.payload.ref.split("/")[2];return e.tmpl(r.pushEvent,{status:t})}else if(t.type==="WatchEvent"){return e.tmpl(r.watchEvent,{status:t})}},s=function(e){var n=[],r=0,s;if(e.query&&e.query.count&&e.query.count>0){s=e.query.count;for(;r<s;r++){var o=e.query.results.json[r].json;n.push({date:new Date(o.created_at),config:t,html:i(o),url:"https://github.com/"+t.user})}}return n};e.ajax({url:e.fn.lifestream.createYqlUrl("select "+"json.type, json.actor, json.repo, json.payload, json.created_at "+'from json where url="https://api.github.com/users/'+t.user+'/events/public?per_page=100"'),dataType:"jsonp",success:function(e){n(s(e))}});return{template:r}}})(jQuery);(function(e){e.fn.lifestream.feeds.googleplus=function(t,n){var r=e.extend({},{posted:'<a href="${actor.url}">${actor.displayName}</a>'+' has posted a new entry <a href="${url}" '+'title="${id}">${title}</a> <!--With--> '+"${object.replies.totalItems} replies, "+"${object.plusoners.totalItems} +1s, "+"${object.resharers.totalItems} Reshares"},t.template),i=function(n){var i=[],s=0,o,u;if(n&&n.items){o=n.items.length;for(;s<o;s++){u=n.items[s];i.push({date:new Date(u.published),config:t,html:e.tmpl(r.posted,u)})}}return i};e.ajax({url:"https://www.googleapis.com/plus/v1/people/"+t.user+"/activities/public",data:{key:t.key},dataType:"jsonp",success:function(e){if(e.error){n([]);if(console&&console.error){console.error("Error loading Google+ stream.",e.error)}return}else{n(i(e))}}});return{template:r}}})(jQuery);(function(e){e.fn.lifestream.feeds.lastfm=function(t,n){var r=e.extend({},{loved:'loved <a href="${url}">${name}</a> by '+'<a href="${artist.url}">${artist.name}</a>'},t.template),i=function(n){var i=[],s,o=0,u;if(n.query&&n.query.count&&n.query.count>0&&n.query.results.lovedtracks&&n.query.results.lovedtracks.track){s=n.query.results.lovedtracks.track;u=s.length;for(;o<u;o++){var a=s[o],f=a.nowplaying?new Date:a.date.uts;i.push({date:new Date(parseInt(f*1e3,10)),config:t,html:e.tmpl(r.loved,a)})}}return i};e.ajax({url:e.fn.lifestream.createYqlUrl("select * from xml where url="+'"http://ws.audioscrobbler.com/2.0/user/'+t.user+'/lovedtracks.xml"'),dataType:"jsonp",success:function(e){n(i(e))}});return{template:r}}})(jQuery);(function(e){e.fn.lifestream.feeds.pinboard=function(t,n){var r=e.extend({},{bookmarked:'bookmarked <a href="${link}">${title}</a>'},t.template);var i=function(n){var i=[],s,o=0,u,a;if(n.query&&n.query.count&&n.query.count>0){s=n.query.results.RDF.item;u=s.length;for(;o<u;o++){a=s[o];i.push({date:new Date(a.date),config:t,html:e.tmpl(r.bookmarked,a)})}}return i};e.ajax({url:e.fn.lifestream.createYqlUrl("select * from xml where "+'url="http://feeds.pinboard.in/rss/u:'+t.user+'"'),dataType:"jsonp",success:function(e){n(i(e))}});return{template:r}}})(jQuery);(function(e){e.fn.lifestream.feeds.slideshare=function(t,n){var r=e.extend({},{uploaded:'uploaded a presentation <a href="${link}">${title}</a>'},t.template);var i=function(n){var i=[],s,o=0,u,a;if(n.query&&n.query.count&&n.query.count>0){s=n.query.results.rss.channel.item;u=s.length;for(;o<u;o++){a=s[o];i.push({date:new Date(a.pubDate),config:t,html:e.tmpl(r.uploaded,a)})}}return i};e.ajax({url:e.fn.lifestream.createYqlUrl("select * from xml where "+'url="http://www.slideshare.net/rss/user/'+t.user+'"'),dataType:"jsonp",success:function(e){n(i(e))}});return{template:r}}})(jQuery);(function(e){e.fn.lifestream.feeds.stackoverflow=function(t,n){var r=e.extend({},{global:'<a href="${link}">${text}</a> - ${title}'},t.template);var i=function(e){var n="",r="",i="",s="http://stackoverflow.com/users/"+t.user,o="http://stackoverflow.com/questions/";if(e.timeline_type==="badge"){i=s+"?tab=reputation"}n=e.timeline_type;r=e.title||e.detail||"";i=i||o+e.post_id;return{link:i,title:r,text:n}},s=function(e){return new Date(e*1e3)};e.ajax({url:"https://api.stackexchange.com/2.1/users/"+t.user+"/timeline?site=stackoverflow",dataType:"jsonp",jsonp:"jsonp",success:function(o){var u=[];if(o&&o.items){for(var a=0;a<o.items.length;a++){var f=o.items[a];u.push({date:s(f.creation_date),config:t,html:e.tmpl(r.global,i(f))})}}n(u)}});return{template:r}}})(jQuery);(function(e){e.fn.lifestream.feeds.tumblr=function(t,n){var r=e.extend({},{posted:'posted a ${type} <a href="${url}">${title}</a>'},t.template),i=t.limit||20,s=function(t){switch(t.type){case"photo":var n=t["photo-url"];return e('<img width="75" height="75"/>').attr({src:n[n.length-1].content,title:a(t),alt:a(t)}).wrap("<div/>").parent().html();case"video":var r=t["video-player"];var i=r[r.length-1].content;if(i.match(/<\s*script/)){return null}return i;case"audio":return t["audio-player"]+" "+e("<div/>").text(a(t)).html();default:return null}},o=function(t,n){return e(t[n]).filter(":not(:empty):first").text()},u=function(e){var t;switch(e.type){case"regular":return e["regular-title"]||o(e,"regular-body");case"link":t=e["link-text"]||o(e,"link-description");if(t===""){t=e["link-url"]}return t;case"video":return o(e,"video-caption");case"audio":return o(e,"audio-caption");case"photo":return o(e,"photo-caption");case"quote":return'"'+e["quote-text"].replace(/<.+?>/g," ").trim()+'"';case"conversation":t=e["conversation-title"];if(!t){t=e.conversation.line;if(typeof t!=="string"){t=t[0].label+" "+t[0].content+" ..."}}return t;case"answer":return e.question;default:return e.type}},a=function(e){var t=u(e)||"";return t.replace(/<.+?>/gi," ")},f=function(t,n){return{date:new Date(n.date),config:t,html:e.tmpl(r.posted,{type:n.type.replace("regular","blog entry"),url:n.url,image:s(n),title:a(n)})}},l=function(n){var r=[],i=0,s,o;if(n.query&&n.query.count&&n.query.count>0){if(e.isArray(n.query.results.posts.post)){s=n.query.results.posts.post.length;for(;i<s;i++){o=n.query.results.posts.post[i];r.push(f(t,o))}}else if(e.isPlainObject(n.query.results.posts.post)){r.push(f(t,n.query.results.posts.post))}}return r};e.ajax({url:e.fn.lifestream.createYqlUrl("select *"+' from tumblr.posts where username="'+t.user+'"'+' and num="'+i+'"'),dataType:"jsonp",success:function(e){n(l(e))}});return{template:r}}})(jQuery);(function(e){"use strict";e.fn.lifestream.feeds.twitter=function(t,n){var r=e.extend({},{posted:"{{html tweet}}"},t.template);var i=function(e){var t=function(e){return e.replace(/([a-z]+:\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,function(e){return'<a href="'+e+'">'+(e.length>25?e.substr(0,24)+"...":e)+"</a>"})},n=function(e){return e.replace(/(^|[^\w]+)\@([a-zA-Z0-9_]{1,15})/g,function(e,t,n){return t+'<a href="http://twitter.com/'+n+'">@'+n+"</a>"})},r=function(e){return e.replace(/(^|[^\w'"]+)\#([a-zA-Z0-9ÅåÄäÖöØøÆæÉéÈèÜüÊêÛûÎî_]+)/g,function(e,t,n){return t+'<a href="http://search.twitter.com/search?q=%23'+n+'">#'+n+"</a>"})};return r(n(t(e)))},s=function(s){var o=[];if(!s.tweets){return o}for(var u=0;u<s.tweets.length;u++){var a=s.tweets[u];o.push({date:new Date(a.createdAt*1e3),config:t,html:e.tmpl(r.posted,{tweet:i(e("<div/>").html(a.text).text()),complete_url:"http://twitter.com/"+t.user+"/status/"+a.id}),url:"http://twitter.com/"+t.user})}n(o)};e.ajax({url:"https://twittery.herokuapp.com/"+t.user,cache:false}).success(s);return{template:r}}})(jQuery);(function(e){e.fn.lifestream.feeds.vimeo=function(t,n){var r=e.extend({},{liked:'liked <a href="${url}" title="${description}">${title}</a>',posted:'posted <a href="${url}" title="${description}">${title}</a>'},t.template),i=function(n,i){var s=[],o=0,u,a,f=i||"liked",l,c;if(n){u=n.length;for(;o<u;o++){a=n[o];if(f==="posted"){l=new Date(a.upload_date.replace(" ","T"))}else{l=new Date(a.liked_on.replace(" ","T"))}if(a.description){c=a.description.replace(/"/g,"'").replace(/<.+?>/gi,"")}else{c=""}s.push({date:l,config:t,html:e.tmpl(r[f],{url:a.url,description:a.description?a.description.replace(/"/g,"'").replace(/<.+?>/gi,""):"",title:a.title})})}}return s};e.ajax({url:e.fn.lifestream.createYqlUrl("SELECT * FROM xml WHERE "+'url="http://vimeo.com/api/v2/'+t.user+'/likes.xml" OR '+'url="http://vimeo.com/api/v2/'+t.user+'/videos.xml"'),dataType:"jsonp",success:function(e){var t=[];if(e.query.results.videos[0]!=null&&e.query.results.videos[0].video.length>0){t=t.concat(i(e.query.results.videos[0].video))}if(e.query.results.videos[1]!=null&&e.query.results.videos[1].video.length>0){t=t.concat(i(e.query.results.videos[1].video,"posted"))}n(t)}});return{template:r}}})(jQuery)